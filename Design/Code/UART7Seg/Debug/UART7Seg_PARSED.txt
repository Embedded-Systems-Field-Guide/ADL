ORG 0:
JMPA MAIN
ORG 4:
JMPA UART_ISR
ORG 30:
MAIN:
MOVD T1_TH 49
MOVD T1_TL 4
MOVD T1_PS 10
MOVD TCON12 240
MOVD UART1_BR 24
MOVD UART1_PS 24
MOVD COM_CON 255
MOVD TRISB 255
MOVD LATB 255
LOOP:
CJNZ UART_ISR RXF
JMPB LOOP
UART_ISR:
CLRB RXF
CLRB RST
MOV SBT UART1_RXBUF
MOVD CALC 48
MOV R1 ALU
CLRB RST
MOV ADD R1
MOVD CALC 9
AJL FAULTVAL
CLRB RST
MOV ADD R1
MOVD CALC B@7Seg
MOVD DPTR_A T@7Seg
MOV DPTR_B ALU
MOVX LATB
JMPA LOOP
7Seg:
DB 189 9 229 109 89 124 252 13 253 93
FAULTVAL:
MOVD LATB 64
JMPA LOOP